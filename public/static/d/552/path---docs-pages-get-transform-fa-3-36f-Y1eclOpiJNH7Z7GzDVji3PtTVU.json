{"data":{"markdownRemark":{"html":"<blockquote>\n<p>This was originally posted to Reddit, I copied it here for convenience</p>\n</blockquote>\n<h2>Problem: Using Parameters</h2>\n<p>I have a workbook that is set up as an Excel Table as follows:</p>\n<center>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Markdown Formula</th>\n<th align=\"center\">News</th>\n<th align=\"center\">URL</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">=\"[\"&#x26;A2&#x26;\"]\"&#x26;\"(\"&#x26;B2&#x26;\")\"</td>\n<td align=\"center\">All</td>\n<td align=\"center\"><a href=\"https://www.investing.com/rss/news.rss\">https://www.investing.com/rss/news.rss</a></td>\n</tr>\n<tr>\n<td align=\"left\">=\"[\"&#x26;A3&#x26;\"]\"&#x26;\"(\"&#x26;B3&#x26;\")\"</td>\n<td align=\"center\">Technology</td>\n<td align=\"center\"><a href=\"https://www.investing.com/rss/news_288.rss\">https://www.investing.com/rss/news_288.rss</a></td>\n</tr>\n<tr>\n<td align=\"left\">=\"[\"&#x26;A4&#x26;\"]\"&#x26;\"(\"&#x26;B4&#x26;\")\"</td>\n<td align=\"center\">Technology</td>\n<td align=\"center\"><a href=\"https://www.investing.com/rss/news_288.rss\">https://www.investing.com/rss/news_288.rss</a></td>\n</tr>\n</tbody>\n</table>\n</center><br/>\n<p>The markdown syntax column is there so I can create a links / cheat sheets page on Github that's similar to this <a href=\"https://github.com/axibase/open-data-catalog/tree/master/data-hosts\">Open Data Catalog Repository</a>, but I'd like the ability to refresh the queries and bring in the most recent news.</p>\n<p>I've read Ken Puls' <a href=\"https://www.excelguru.ca/blog/2014/11/26/building-a-parameter-table-for-power-query/\">blog post</a> where he creates the <code class=\"language-text\">fnGetParameters()</code> function and I think something like that might work if I added a <code class=\"language-text\">category</code> column and a few lines of VBA to refresh each category periodically:</p>\n<div class=\"gatsby-highlight\" data-language=\"visual-basic\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-visual-basic line-numbers\"><code class=\"language-visual-basic\"><span class=\"token comment\">'Attribute VB_Name = \"Module1\"</span>\n<span class=\"token keyword\">Dim</span> NextTick <span class=\"token keyword\">as</span> <span class=\"token keyword\">Date</span>\n<span class=\"token comment\">'------------------------------------------------------------------------------</span>\n<span class=\"token keyword\">Sub</span> UpdateClock<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">'   Puts the current time in A1 and creates an event 30 mintes from now</span>\n    This<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">.</span>Sheets<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Range<span class=\"token punctuation\">(</span><span class=\"token string\">\"A1\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Time\n    NextTick <span class=\"token operator\">=</span> Now <span class=\"token operator\">+</span> TimeValue<span class=\"token punctuation\">(</span><span class=\"token string\">\"00:30:00\"</span><span class=\"token punctuation\">)</span>\n    Application<span class=\"token punctuation\">.</span>OnTime NextTick<span class=\"token punctuation\">,</span> <span class=\"token string\">\"UpdateClock\"</span>\n<span class=\"token comment\">'   I would adjust the next line for each category</span>\n    ThisWorkbook<span class=\"token punctuation\">.</span>RefreshAll\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span>\n<span class=\"token comment\">'------------------------------------------------------------------------------</span>\n<span class=\"token keyword\">Sub</span> StopClock<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">'   Cancel the future event</span>\n    <span class=\"token keyword\">On</span> <span class=\"token keyword\">Error</span> <span class=\"token keyword\">Resume</span> <span class=\"token keyword\">Next</span>\n    Application<span class=\"token punctuation\">.</span>OneTime NextTick<span class=\"token punctuation\">,</span> <span class=\"token string\">\"UpdateClock\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">FALSE</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span>\n<span class=\"token comment\">'------------------------------------------------------------------------------</span>\n<span class=\"token comment\">'------------------------------------------------------------------------------</span>\n<span class=\"token comment\">'   Attribute VB_Name = \"ThisWorkbook\"</span>\n<span class=\"token comment\">'   Makes sure the workbook doesn't keep calculating</span>\n<span class=\"token keyword\">Private</span> <span class=\"token keyword\">Sub</span> Workbook_BeforeClose<span class=\"token punctuation\">(</span>Cancel <span class=\"token keyword\">as</span> <span class=\"token keyword\">Boolean</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">Call</span> StopClock\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>I'm already using the VBA in a workbook that pulls data from Excel's new <code class=\"language-text\">Stocks</code> data-type API and it's <a href=\"https://www.youtube.com/watch?v=W_14DoSfGIM\">working wonderfully</a>, but I'd like to have the latest news as well as my account balances. The URLs in this case happen to be .rss files, but this could be applied to any interactions with APIs that have multiple endpoints.</p>\n<p>I'm open to any and all suggestions and am familiar enough to understand solutions in VBA, #M, JavaScript and R.</p>","frontmatter":{"title":"Get & Transform","date":"2018-08-08"}}},"pageContext":{"slug":"/docs/pages/Get&Transform/"}}